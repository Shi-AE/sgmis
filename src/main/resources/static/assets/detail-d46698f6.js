import{_ as $,r as a,o as p,c as h,f as i,t as l,C as f,b,q as y,H as x,L as S,D as w,G as z,z as B,d as I,E as N}from"./index-87c3fdd7.js";import{i as O}from"./index-e90ad19a.js";const R={props:{urls:Array}},G={class:"picture"};function L(t,e,n,r,o,c){const s=a("a-divider"),_=a("a-image"),d=a("a-space"),u=a("a-image-preview-group"),m=a("a-empty");return p(),h(x,null,[i(s,{size:2,style:{"border-bottom-style":"dotted"},orientation:"left"},{default:l(()=>[f("鸽子图片")]),_:1}),b("div",G,[n.urls.length?(p(),y(u,{key:0,infinite:""},{default:l(()=>[i(d,null,{default:l(()=>[(p(!0),h(x,null,S(n.urls,v=>(p(),h("div",null,[i(_,{width:"200",height:"200",fit:"contain",src:v},null,8,["src"])]))),256))]),_:1})]),_:1})):w("",!0),n.urls.length?w("",!0):(p(),y(m,{key:1,description:"暂无图片"}))])],64)}const A=$(R,[["render",L],["__scopeId","data-v-3260918e"]]);const H={props:{tree:Object},beforeUpdate(){const t={renderer:"svg",useDirtyRect:!0,locale:"ZH"};O(this.$refs.bloodline,null,t).setOption(this.getOption())},methods:{getOption(){return{title:{text:`${this.tree[0].value.pigeon.ringNumber}`,subtext:`${this.tree[0].value.pigeon.name??""}
${this.tree[0].value.pigeon.bloodline??""}`},tooltip:{trigger:"none",triggerOn:"none"},series:[{type:"tree",orient:"LR",top:"0%",left:"12%",bottom:"0%",right:"12%",edgeShape:"polyline",symbol:"none",initialTreeDepth:-1,expandAndCollapse:!1,roam:"move",label:{borderWidth:10,padding:10,borderColor:"#eee",backgroundColor:"#fff",width:200,overflow:"truncate",formatter:t=>{const e=t.value.pigeon,n=t.value.pigeonInfo;return[e!=null&&e.ringNumber?`{text|${e.ringNumber}}`:"{placeholder|}","{hr|}",e!=null&&e.name?`{text|${e.name}}`:"{empty|}",`{text|${(e==null?void 0:e.sex)??""} ${(e==null?void 0:e.ys)??""} ${(e==null?void 0:e.yan)??""}}`,e!=null&&e.bloodline?`{text|${e.bloodline}}`:"{empty|}",n!=null&&n.detail?`{text|${n.detail}}`:"{empty|}"].join(`
`)},rich:{title:{align:"center",fontSize:15,height:30},text:{height:30,fontSize:15},empty:{height:0},placeholder:{height:30},hr:{borderColor:"#777",width:"100%",borderWidth:.5,height:0}}},data:this.tree}]}}}},j={ref:"bloodline",class:"bloodline"};function F(t,e,n,r,o,c){return p(),h("div",j,null,512)}const V=$(H,[["render",F],["__scopeId","data-v-6032d578"]]);const W={data(){return{pigeonResourcePath:`${window.location.protocol}//${window.location.hostname}/pigeon`,columns:[{title:"序号",dataIndex:"key",align:"center",sortable:{sortDirections:["descend"]}},{title:"足环",slotName:"ringNumber",align:"center",filterable:{filter:(t,e)=>{var n,r,o;return((n=e.ringNumber)==null?void 0:n.includes(t))||((r=e.name)==null?void 0:r.includes(t))||((o=e.bloodline)==null?void 0:o.includes(t))},slotName:"ringNumber-filter",icon:()=>z(B)}},{title:"名称",dataIndex:"name",align:"center"},{title:"图片",slotName:"picture",align:"center",width:70},{title:"代数",dataIndex:"generation",align:"center"},{title:"性别",dataIndex:"sex",align:"center"},{title:"羽色",dataIndex:"ys",align:"center"},{title:"眼砂",dataIndex:"yan",align:"center"},{title:"赛绩鸽",dataIndex:"isGrade",align:"center"},{title:"类型",dataIndex:"lx",align:"center"},{title:"状态",dataIndex:"state",align:"center"}],data:null}},mounted(){I({method:"GET",url:`detail/offspring/${this.$route.params.id}`,message:"正在查询子代"}).then(t=>{if(t.data.code===200){const e=[];t.data.data.forEach((n,r)=>{r>0&&n.length>0&&n.forEach(o=>{e.push({...o,key:e.length+1,generation:r})})}),this.data=e}})}},J={class:"custom-filter"},q={class:"custom-filter-footer"};function Z(t,e,n,r,o,c){const s=a("a-image"),_=a("a-tooltip"),d=a("routerLink"),u=a("a-input"),m=a("a-button"),v=a("a-space"),k=a("a-empty"),C=a("a-table");return p(),y(C,{columns:o.columns,data:o.data,bordered:{cell:!0}},{picture:l(({record:g})=>[g.pictureUrl?(p(),y(s,{key:0,src:`${o.pigeonResourcePath}/${g.pictureUrl}`,width:"100%",height:"100%",fit:"contain"},null,8,["src"])):w("",!0)]),ringNumber:l(({record:g})=>[i(d,{to:{name:"detail",params:{id:g.id}},style:{color:"#D91AD9"}},{default:l(()=>[i(_,{content:"点击查看鸽子详情",mini:!0,"background-color":"#FDC2DB"},{default:l(()=>[b("div",null,N(g.ringNumber),1)]),_:2},1024)]),_:2},1032,["to"])]),"ringNumber-filter":l(({filterValue:g,setFilterValue:D,handleFilterConfirm:E,handleFilterReset:U})=>[b("div",J,[i(v,{direction:"vertical"},{default:l(()=>[i(u,{"model-value":g[0],onInput:P=>D([P])},null,8,["model-value","onInput"]),b("div",q,[i(m,{onClick:E},{default:l(()=>[f("搜索")]),_:2},1032,["onClick"]),i(m,{onClick:U},{default:l(()=>[f("重置")]),_:2},1032,["onClick"])])]),_:2},1024)])]),empty:l(()=>[i(k,{description:"暂无子代"})]),_:1},8,["columns","data"])}const K=$(W,[["render",Z]]);const M={data(){return{pigeonResourcePath:`${window.location.protocol}//${window.location.hostname}/pigeon`,columns:[{title:"序号",dataIndex:"key",align:"center",sortable:{sortDirections:["descend"]}},{title:"足环",slotName:"ringNumber",align:"center",filterable:{filter:(t,e)=>{var n,r,o;return((n=e.ringNumber)==null?void 0:n.includes(t))||((r=e.name)==null?void 0:r.includes(t))||((o=e.bloodline)==null?void 0:o.includes(t))},slotName:"ringNumber-filter",icon:()=>z(B)}},{title:"名称",dataIndex:"name",align:"center"},{title:"图片",slotName:"picture",align:"center",width:70},{title:"平辈关系",dataIndex:"relation",align:"center"},{title:"性别",dataIndex:"sex",align:"center"},{title:"羽色",dataIndex:"ys",align:"center"},{title:"眼砂",dataIndex:"yan",align:"center"},{title:"赛绩鸽",dataIndex:"isGrade",align:"center"},{title:"类型",dataIndex:"lx",align:"center"},{title:"状态",dataIndex:"state",align:"center"}],data:null}},mounted(){I({method:"GET",url:`detail/peer/${this.$route.params.id}`,message:"正在查询子代"}).then(t=>{var e,n,r;if(t.data.code===200){const o=t.data.data,c=[];((e=o.fatherHalf)==null?void 0:e.length)>0&&o.fatherHalf.forEach(s=>{c.push({...s,key:c.length+1,relation:"同父异母"})}),((n=o.motherHalf)==null?void 0:n.length)>0&&o.motherHalf.forEach(s=>{c.push({...s,key:c.length+1,relation:"同母异父"})}),((r=o.full)==null?void 0:r.length)>0&&o.full.forEach(s=>{c.push({...s,key:c.length+1,relation:"同父同母"})}),this.data=c}})}},Q={class:"custom-filter"},X={class:"custom-filter-footer"};function Y(t,e,n,r,o,c){const s=a("a-image"),_=a("a-tooltip"),d=a("routerLink"),u=a("a-input"),m=a("a-button"),v=a("a-space"),k=a("a-empty"),C=a("a-table");return p(),y(C,{columns:o.columns,data:o.data,bordered:{cell:!0}},{picture:l(({record:g})=>[g.pictureUrl?(p(),y(s,{key:0,src:`${o.pigeonResourcePath}/${g.pictureUrl}`,width:"100%",height:"100%",fit:"contain"},null,8,["src"])):w("",!0)]),ringNumber:l(({record:g})=>[i(d,{to:{name:"detail",params:{id:g.id}},style:{color:"#D91AD9"}},{default:l(()=>[i(_,{content:"点击查看鸽子详情",mini:!0,"background-color":"#FDC2DB"},{default:l(()=>[b("div",null,N(g.ringNumber),1)]),_:2},1024)]),_:2},1032,["to"])]),"ringNumber-filter":l(({filterValue:g,setFilterValue:D,handleFilterConfirm:E,handleFilterReset:U})=>[b("div",Q,[i(v,{direction:"vertical"},{default:l(()=>[i(u,{"model-value":g[0],onInput:P=>D([P])},null,8,["model-value","onInput"]),b("div",X,[i(m,{onClick:E},{default:l(()=>[f("搜索")]),_:2},1032,["onClick"]),i(m,{onClick:U},{default:l(()=>[f("重置")]),_:2},1032,["onClick"])])]),_:2},1024)])]),empty:l(()=>[i(k,{description:"暂无平辈"})]),_:1},8,["columns","data"])}const ee=$(M,[["render",Y]]);const te={data(){return{log:[],color:["#F08EE6","#E865DF","#E13EDB","#D91AD9","#B010B6","#8A0993","#650370"]}},mounted(){I({method:"GET",url:`oplog/${this.$route.params.id}/5`,message:"正在查询日志"}).then(t=>{t.data.code?this.log=t.data.data:Notification.error(t.data.message)})}},ne={class:"log"};function oe(t,e,n,r,o,c){const s=a("a-timeline-item"),_=a("a-timeline"),d=a("a-button");return p(),h("div",ne,[i(_,null,{default:l(()=>[(p(!0),h(x,null,S(o.log,(u,m)=>(p(),h("div",{key:m},[i(s,{"dot-type":"hollow","dot-color":o.color[m],label:u.time},{default:l(()=>[f(N(u.tip),1)]),_:2},1032,["dot-color","label"])]))),128))]),_:1}),i(d,{size:"mini",shape:"round",type:"outline",onClick:e[0]||(e[0]=u=>t.$router.push({name:"log"}))},{default:l(()=>[f("更多")]),_:1})])}const ae=$(te,[["render",oe]]);const ie={components:{Bloodline:V,Offspring:K,SameGeneration:ee,Log:ae},props:{tree:Object}},le={class:"content"};function re(t,e,n,r,o,c){const s=a("a-divider"),_=a("bloodline"),d=a("a-tab-pane"),u=a("offspring"),m=a("same-generation"),v=a("log"),k=a("a-tabs");return p(),h(x,null,[i(s,{size:2,style:{"border-bottom-style":"dotted"},orientation:"left"},{default:l(()=>[f("详细资料")]),_:1}),b("div",le,[i(k,{type:"line","lazy-load":""},{default:l(()=>[i(d,{key:"1",title:"血统"},{default:l(()=>[i(_,{tree:n.tree},null,8,["tree"])]),_:1}),i(d,{key:"2",title:"子代资料"},{default:l(()=>[i(u)]),_:1}),i(d,{key:"3",title:"平辈资料"},{default:l(()=>[i(m)]),_:1}),i(d,{key:"4",title:"日志"},{default:l(()=>[i(v)]),_:1})]),_:1})])],64)}const se=$(ie,[["render",re],["__scopeId","data-v-a2ddb28a"]]);const ce={props:{tree:Object},data(){return{data:null}},beforeUpdate(){const t=this.tree[0].value,e=t.pigeon,n=t.pigeonInfo;this.data=[{label:"鸽棚/巢箱位置",value:e.gpcx??"-"},{label:"入库时间",value:n.createTime??"-"},{label:"性别",value:e.sex??"-"},{label:"眼砂",value:e.yan??"-"},{label:"羽色",value:e.ys??"-"},{label:"作育者",value:n.source??"-"},{label:"血统名称",value:e.bloodline??"-"},{label:"类型",value:e.lx??"-"},{label:"级别",value:e.jb??"-"}]}},de={class:"descriptions"};function _e(t,e,n,r,o,c){const s=a("a-divider"),_=a("a-tag"),d=a("a-descriptions-item"),u=a("a-descriptions");return p(),h(x,null,[i(s,{size:2,style:{"border-bottom-style":"dotted"},orientation:"left"},{default:l(()=>[f("基本资料")]),_:1}),b("div",de,[i(u,{data:o.data,title:"数据表",size:"large",layout:"horizontal",column:{xxl:6,xl:5,lg:4,md:3,sm:2,xs:1}},{default:l(()=>[(p(!0),h(x,null,S(o.data,m=>(p(),y(d,{label:m.label},{default:l(()=>[i(_,null,{default:l(()=>[f(N(m.value),1)]),_:2},1024)]),_:2},1032,["label"]))),256))]),_:1},8,["data"])])],64)}const ue=$(ce,[["render",_e],["__scopeId","data-v-99b395a8"]]),pe=[400,400,280,120],T=[0,70,0,-27],me={components:{Picture:A,Content:se,Stats:ue},data(){return{pigeonResourcePath:`${window.location.protocol}//${window.location.hostname}/pigeon`,data:null}},async mounted(){await this.initData()},methods:{async initData(){this.data=[await this.createTree(this.$route.params.id,"我",0)]},async createTree(t,e,n){if(n<4){let r={name:e,value:{pigeon:{id:t}},label:{height:pe[n],offset:[0,e==="母"?-T[n]:T[n]]},children:[]};t&&await I({method:"GET",url:`pigeon/${t}`,message:"正在获取鸽子数据"}).then(s=>{s.data.code===200&&(r.value=JSON.parse(JSON.stringify(s.data.data)))});const o=await this.createTree(r.value.pigeon.fid,"父",n+1);o&&r.children.push(o);const c=await this.createTree(r.value.pigeon.mid,"母",n+1);return c&&r.children.push(c),r}},getPictureUrl(){var e,n,r,o,c,s;const t=[];if(this.data){const _=this.data[0];(n=(e=_==null?void 0:_.value)==null?void 0:e.pigeon)!=null&&n.pictureUrl&&t.push(`${this.pigeonResourcePath}/${_.value.pigeon.pictureUrl}`);const d=_.children[0];(o=(r=d==null?void 0:d.value)==null?void 0:r.pigeon)!=null&&o.pictureUrl&&t.push(`${this.pigeonResourcePath}/${d.value.pigeon.pictureUrl}`);const u=_.children[1];(s=(c=u==null?void 0:u.value)==null?void 0:c.pigeon)!=null&&s.pictureUrl&&t.push(`${this.pigeonResourcePath}/${u.value.pigeon.pictureUrl}`)}return t}}};function ge(t,e,n,r,o,c){const s=a("Picture"),_=a("Stats"),d=a("Content");return p(),h(x,null,[i(s,{urls:c.getPictureUrl()},null,8,["urls"]),i(_,{tree:o.data},null,8,["tree"]),i(d,{tree:o.data},null,8,["tree"])],64)}const be=$(me,[["render",ge]]);export{be as default};

import{_ as M,d as g,F as q,N as h,r as s,o as V,c as S,f as e,t,b as x,H as k,C as m,L as F,q as E}from"./index-87c3fdd7.js";const I={data(){return{form:{fid:null,mid:null,pigeon:[{country:null,year:null,province:null,code:null,sex:null}]},options:{fatherOptions:[],motherOptions:[],countryOptions:[],provinceOptions:[]}}},mounted(){g({method:"GET",url:"xxpz/country",message:"正在获取系统信息"}).then(l=>{l.data.code===200&&(this.options.countryOptions=l.data.data.map(o=>{const n=o.name.split("/");return{label:`${n[0]}${n[1]}`,value:n[1]}}))}),g({method:"GET",url:"xxpz/province",message:"正在获取系统信息"}).then(l=>{l.data.code===200&&(this.options.provinceOptions=l.data.data.map(o=>{const n=o.name.split("/");return{label:`${n[0]}${n[1]}`,value:n[1]}}))})},methods:{search(l,o){l&&g({method:"GET",url:`rapid/${o}/${l}`}).then(n=>{if(n.data.code===200){const r=n.data.data.map(d=>({label:d.ringNumber,value:String(d.id)}));o==="father"?this.options.fatherOptions=r:o==="mother"&&(this.options.motherOptions=r)}})},handleFatherSearch(l){this.search(l,"father")},handleMotherSearch(l){this.search(l,"mother")},addForm(){this.form.pigeon.push({country:null,year:null,province:null,code:null,sex:null})},addSame(){const l=JSON.parse(JSON.stringify(this.form.pigeon[this.form.pigeon.length-1]));this.form.pigeon.push(l)},deleteItem(l){this.form.pigeon.splice(l,1)},copyItem(l){const o=JSON.parse(JSON.stringify(this.form.pigeon[l]));this.form.pigeon.splice(l,0,o)},commit(){const l=[];q(()=>{const o=this.form;if(!o.mid&&!o.fid)return h.warning("至少输入一个父代信息"),!1;if(o.pigeon.length===0)return h.warning("至少输入一个子代信息"),!1;let n=!0;if(o.pigeon.forEach(r=>{if(!r.code||!r.year||!r.province||!r.country||!r.sex){n=!1;return}l.push({ringNumber:[r.country,r.year,r.province,r.code].join("-"),sex:r.sex})}),!n)return h.warning("子代信息不完整"),!1},"验证数据")&&g({method:"POST",url:"rapid",data:{fid:this.form.fid,mid:this.form.mid,pigeons:l},message:"正在快速入库"}).then(o=>{o.data.code===200?h.success(o.data.message):h.error(`${o.data.message}，如需添加血亲关系，请移步血统编辑`)})}}},T={class:"button-group"},B={class:"button-group"},J={class:"button-group"};function G(l,o,n,r,d,u){const y=s("a-divider"),f=s("a-select"),p=s("a-form-item"),c=s("a-grid-item"),O=s("a-grid"),z=s("a-form"),_=s("a-button"),v=s("a-space"),w=s("a-year-picker"),U=s("a-input"),N=s("a-list-item"),C=s("a-list");return V(),S(k,null,[e(y,{size:2,style:{"border-bottom-style":"dotted"},orientation:"left"},{default:t(()=>[m("父母信息")]),_:1}),e(z,{model:d.form,layout:"horizontal","auto-label-width":!0},{default:t(()=>[e(O,{cols:{md:2,sm:1,xs:1},"col-gap":10,style:{margin:"0 30px"}},{default:t(()=>[e(c,null,{default:t(()=>[e(p,{label:"父亲环号"},{default:t(()=>[e(f,{modelValue:d.form.fid,"onUpdate:modelValue":o[0]||(o[0]=a=>d.form.fid=a),modelModifiers:{lazy:!0},options:d.options.fatherOptions,placeholder:"父亲环号","allow-search":"",onSearch:u.handleFatherSearch},null,8,["modelValue","options","onSearch"])]),_:1})]),_:1}),e(c,null,{default:t(()=>[e(p,{label:"母亲环号"},{default:t(()=>[e(f,{modelValue:d.form.mid,"onUpdate:modelValue":o[1]||(o[1]=a=>d.form.mid=a),modelModifiers:{lazy:!0},options:d.options.motherOptions,placeholder:"母亲环号","allow-search":"",onSearch:u.handleMotherSearch},null,8,["modelValue","options","onSearch"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),e(y,{size:2,style:{"border-bottom-style":"dotted"},orientation:"left"},{default:t(()=>[m("新建鸽子信息")]),_:1}),x("div",T,[e(v,{wrap:""},{default:t(()=>[e(_,{type:"primary",status:"success",onClick:o[2]||(o[2]=a=>u.addForm())},{default:t(()=>[m("增加")]),_:1})]),_:1})]),e(C,{bordered:!0,size:"large"},{default:t(()=>[(V(!0),S(k,null,F(d.form.pigeon,(a,b)=>(V(),E(N,{class:"list-group-item",key:b},{default:t(()=>[e(z,{model:a,layout:"horizontal","auto-label-width":!0},{default:t(()=>[e(O,{cols:{xxl:4,md:3,sm:2,xs:1}},{default:t(()=>[e(c,null,{default:t(()=>[e(p,{label:"国家",extra:"由“-”组合成足环","validate-trigger":"blur",required:""},{default:t(()=>[e(f,{modelValue:a.country,"onUpdate:modelValue":i=>a.country=i,modelModifiers:{lazy:!0},options:d.options.countryOptions,placeholder:"国家","allow-search":""},null,8,["modelValue","onUpdate:modelValue","options"])]),_:2},1024)]),_:2},1024),e(c,null,{default:t(()=>[e(p,{label:"出生年份","validate-trigger":"blur",required:""},{default:t(()=>[e(w,{modelValue:a.year,"onUpdate:modelValue":i=>a.year=i,modelModifiers:{lazy:!0}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(c,null,{default:t(()=>[e(p,{label:"省份代号","validate-trigger":"blur",required:""},{default:t(()=>[e(f,{modelValue:a.province,"onUpdate:modelValue":i=>a.province=i,modelModifiers:{lazy:!0},options:d.options.provinceOptions,placeholder:"省份代号","allow-search":""},null,8,["modelValue","onUpdate:modelValue","options"])]),_:2},1024)]),_:2},1024),e(c,null,{default:t(()=>[e(p,{label:"编号","validate-trigger":"blur",required:""},{default:t(()=>[e(U,{modelValue:a.code,"onUpdate:modelValue":i=>a.code=i,modelModifiers:{lazy:!0},placeholder:"编号"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(p,{label:"性别",required:""},{default:t(()=>[e(f,{modelValue:a.sex,"onUpdate:modelValue":i=>a.sex=i,modelModifiers:{lazy:!0},options:["雄","雌"],placeholder:"性别"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["model"]),x("div",B,[e(v,{wrap:""},{default:t(()=>[e(_,{type:"outline",status:"danger",onClick:i=>u.deleteItem(b)},{default:t(()=>[m("删除")]),_:2},1032,["onClick"]),e(_,{type:"outline",status:"normal",onClick:i=>u.copyItem(b)},{default:t(()=>[m("复制")]),_:2},1032,["onClick"])]),_:2},1024)])]),_:2},1024))),128))]),_:1}),x("div",J,[e(v,{wrap:""},{default:t(()=>[e(_,{type:"primary",status:"normal",onClick:o[3]||(o[3]=a=>u.addSame())},{default:t(()=>[m("同上")]),_:1})]),_:1})]),e(y,{size:2,style:{"border-bottom-style":"dotted"},orientation:"left"}),e(_,{type:"primary",onClick:o[4]||(o[4]=a=>u.commit()),size:"large",long:""},{default:t(()=>[m("保存")]),_:1})],64)}const j=M(I,[["render",G],["__scopeId","data-v-6aa8a835"]]);export{j as default};
